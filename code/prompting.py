# -*- coding: utf-8 -*-
"""Prompting.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1CgEnCwcnnISs5ZlIJWSol0dIKM0a6s5s
"""

!pip install transformers --quiet
!pip install torch --quiet
!pip install -q transformers accelerate --quiet
!nvidia-smi

from transformers import pipeline
import torch

torch.manual_seed(0)
generator = pipeline('text-generation', model = 'gpt2')
prompt = "Hello, I'm a language model"

generator(prompt, max_length = 30)

from transformers import pipeline, AutoTokenizer
import torch

torch.manual_seed(0)
model = "tiiuae/falcon-7b-instruct"

tokenizer = AutoTokenizer.from_pretrained(model)
pipe = pipeline(
    "text-generation",
    model=model,
    tokenizer=tokenizer,
    torch_dtype=torch.bfloat16,
    device_map="auto",
)

torch.manual_seed(1)
prompt = """Return a list of named entities in the text.
Text: The Golden State Warriors are an American professional basketball team based in San Francisco.
Named entities:
"""

sequences = pipe(
    prompt,
    max_new_tokens=15,
    return_full_text = False,
)

for seq in sequences:
    print(f"{seq['generated_text']}")